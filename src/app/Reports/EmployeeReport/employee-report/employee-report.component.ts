import { Component, OnInit } from '@angular/core';
import { EmployeeReportService } from '../../../services/employee-report.service';
import { Employee } from '../../../models/employee';
import { jsPDF } from 'jspdf';
import 'jspdf-autotable';
import * as XLSX from 'xlsx';

@Component({
  selector: 'app-employee-report',
  templateUrl: './employee-report.component.html',
  styleUrl: './employee-report.component.css'
})
export class EmployeeReportComponent implements OnInit {
  employees: Employee[] = [];
    filteredEmployees: Employee[] = [];

    constructor(private employeeReportService: EmployeeReportService) {}

    ngOnInit(): void {
        this.loadEmployeeReport();
    }

    loadEmployeeReport(): void {
        this.employeeReportService.getEmployeeReport().subscribe(data => {
            this.employees = data;
            this.filteredEmployees = data;
        });
    }

    filterEmployees(event: Event): void {
      const input = event.target as HTMLInputElement | null; // Type assertion
      if (input) {
          const query = input.value; // Now safe to access value
          this.filteredEmployees = this.employees.filter(e =>
              e.empFirstName.toLowerCase().includes(query.toLowerCase()) ||
              e.empLastName.toLowerCase().includes(query.toLowerCase()) ||
              e.empEmail.toLowerCase().includes(query.toLowerCase())
          );
      }
  }

  base64Image: string = '/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAYGBgYHBgcICAcKCwoLCg8ODAwODxYQERAREBYiFRkVFRkVIh4kHhweJB42KiYmKjY+NDI0PkxERExfWl98fKcBBgYGBgcGBwgIBwoLCgsKDw4MDA4PFhAREBEQFiIVGRUVGRUiHiQeHB4kHjYqJiYqNj40MjQ+TERETF9aX3x8p//CABEIAbICAwMBIgACEQEDEQH/xAAwAAEAAgMBAAAAAAAAAAAAAAAAAQIDBAUGAQEBAQEBAAAAAAAAAAAAAAAAAQIDBP/aAAwDAQACEAMQAAAC9UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABE0LgAAAAAAAAAAAAAAAAAAAAAAAAAAAAECjDbmnXsbDHeSyJAAAAAAAAAAAAAAAAAAIkAABBIACILIkAiUExGEmpqxKC2TFkknJgyRcAAAABjqmZWC6JUAAAAAAAAAAAAAAQTFal61LaaibYFZsOutz0xxWyw5ZJqJW+K1ZMuDLGZS+RisXpbGkWpOpas1lTM2Vi4taJzoAAAAAAAAAACImoAgVFoqkTRZisVNZxE4oaqYJaYWXyYkmdMRS1ZS18YzThsTMEmazFpSK3SwmBW1bMsxOaCgAAAAAAAACpMAApixW7NNeLdimKLc2PDYuiLJhJWZIWJjtjtZnvq3jKxwmRjmy8UJeqUma2Nm+rmxrKpOdBURKzIM6AAAAAAAAAAVtBCIETgtxIjWkTBAqEyiJhESsIkmakUtWyb4rJktEyABZM1JaFomYkvbFOdbKJxusXEhQAAAAAAAACNY2aYYtzMdidPb1bYOXbn0eZ15mvR1OWelVtpKMSZVZslWbASa2JjmVza2OxeazEooTy+bbGtvdc49HPI62szME2L6+xz6xMTLIUAAAAAAAACmtmw2xS8WxkpUvjrNU8t6TzEm16PznoEtwN7BXSZNLU5OA530uSlu2LTQl4rKWVJdFkJItSS3I6/Azrnej856LG9/Wnkb537+rskolLbOrtY6TJnoAAAAAAAAABr471tWKjHlg114rF5P2PlMzD1OX6EbOSnSV0OhzU49q5uV9El6OcBBNiYJN8cpkVmFscpl4Xc5md8LZ1trl16PTmevCUSlprbOmfBkzvYmJz1AAAAAAAAAA16ZMdpMUpkxlZibL+e9Dz481vaLM9hXDm6ynJ6/HTl7Gvt89d4d+IWJmYrMylJtpG3HP6NzErXM4szOvINnW8/q9Jt8Dv9fPNq3lmVppMM6vm1881YNAAAAAAAAAYK5MdRMKgJSUaTUPIU6XN5ur2/Jer3I4nb4VnP3tHLjXR1uzwt46u55b0ms5tCOJL393zfotY5nI29Tl1yen8v6rfOLw3yvEs643H9T5bn3n1fk+1HYlN5rE1JMrPg2GpDQAAAAAAAAEY8o12XHZWt61XFm81W71Ob0053nfY+Plj0nm+tHd836Pzes6PV5Xcl6PC3+RrOvv6HRxrW19rVXf7fL6nXh5vDsa/Ltf1nlPWb5xzcuum1fj9yXP5X1fCl5O1qs9Pazhy3nNoSyiZWxgzrIugAAAAAAAAAESMePPr2avH39ezrjWZ8p6rgy8nc09vOvTea9N5jWNTr8jqZ1uaHc4O8aHX5Hp864mn3OHL2smhk3ieX3OHjeb1Hlujcsfc88egyTDE6G9jl8kJ19Rvc3ozOREyiSMtLrcaoAAAAAAAACJgEJXXz4dTQ5ve8oetjHk1lyOxwTkdDn+ixroef8AQOnPy3odgcXl+srLyu1M3NeZ1UcPqTxJq/J2dbHTa9PwfQ3FfM+l5KdK3E7hEqSeWxzszr39pOczaare1bWslcloUAAAAAAAAAiRESMeHNj3muj0IZ8p1+hoLj4Xf3Dldq8XFUtZgBISZrBn87NU7t8svmuftaud9vt83oXEVvEnnr97UmsfJ6eQ4PpM9s1aLxKbWxatlvNL6BQAAAAAAAAAAgx48lNYiLRYraLKrRZJKViwqlELRLEpK+c9J53OvQVyaaeXiN+dPQZqyxIyCUSpKVaMi2peKraJibxOwUAAAAAAAAAABXHmx3NFlmOMtbKxMXMJqkqyWViW6kxZWVnhd2sulytrFNcn1LaiJlIEomImbLSZmWL1tV4iC00yVI2AAAAAAAAAAAABIiwit4MdMtNZpW65xzaSkXRRdEJmUSsESiYiLCrJWWszMsSQJWMlMlVTBGStrEmgUAAAAAAAAAAAAAAraqVRFlqWlMTLBSbxLWSE2lccZRitkkpaQiS465KZVSxSMgmXSVSlTE2JNAAAAAAAAAAAAACuJM7DZMlRaxaErNgtFlBUSSElgEgiYmIkpWyMa9covFqVsqskBUigAAAAAAAAAAAAKYtirODLeTHaxYiwqsAUAREomgAAAAAitgAhIACgAAAAAAAAAAASspAUAAAAAAAAAAAiYAiQCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/8QAAv/aAAwDAQACAAMAAAAhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQY2AAAAAAAAAAAAAAAAAAAgAAAAAMIAAbhkDGAAAAALNIAAAAAAAAAAAAAAEJqio8YKbQwIKDJ+l5oAAAAAAAAAAAV/wDjNgN7t8RZL4kPciXnqCQAAAAAAAAABKEmeYLpfvsmxpkaz8z7rOAAAAAAAAAAAFI4BQwMz0SIvjq1nJWyXh8gAAAAAAAAAB/CAhIFvqmic+27b3n3bCiOQAAAAAAAAAAzb0TG0sdNf3vv0zzVvwj0oAAAAAAAAAAH4Ud+5hsw0TmLCav1Ebv/AMogAAAAAAAAACYRZ7IcJEQd3KbKBz3KHpFbUAAAAAAAAACey/gAMpoEl1ThFrMKS4fZ90AAAAAAAAACBddD4ApYGAMx4+wZZ3021+sAAAAAAAAAABCbu9lndqF5JTa0Be814JeMAAAAAAAAABBe4bWEbaxjV/S7Z5ylPZKyAAAAAAAAAABBhBOCxNG7FbRRoR4ZX69/6oAAAAAAAAAAASNZXQln86n+bywc9zQJK8gAAAAAAAAAAABWrIqds5vjWSqRxfvoF9sAAAAAAAAAAAAAFFLxAgnN9lw5EGqNjziOIAAAAAAAAAAAAAABIh2ViYawGNI3ouHg+AAAAAAAAAAAAAAQMKffEBHDwAqBKckDLQAAAAAAAAAAAAAAeOEFEAAIgAAAAAKILIIAAAAAAAAAAAAGEAAAAAAAAAAAAIKIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/xAAC/9oADAMBAAIAAwAAABDzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzjzzzzzzzzzzzzzzzzzzzzzzzzzzzzzyj/1TzjzzzzzzzzzzzzzzzzjzzDzzjzzyAy3TfzzzzTrvzzzzzzzzzzzzzTzxdfOsAlyFmDrSWlZhj7zzzzzzzzzzyqlRiC3tjO1YUPhjneBHUj3zzzzzzzzzzza1dYi+VCyPQ5eQnegE9NHzzzzzzzzzzxgSkbbDYb864TaL52hKayDPzzzzzzzzzyxmXEKz7Jcsrl6d1blXaYVdbzzzzzzzzzxzsXbiOmljQKveFuZrnGWpVDzzzzzzzzzwnHNxf4Ljuz/ANQkjua/tZPuc8888888888VnQXo5BD5Dp+vSf8AYJv2vLkvPPPPPPPPPIL+6fPRNuA2Ib78qIeR8xcxPPPPPPPPPPDrUmx+IH+KuOEMC65YwrbQNfPPPPPPPPPPPN5YV8Ot7KLrIJYO3sVGsMvPPPPPPPPPPNU44tO8jS3HvegxyASr2YSPPPPPPPPPLHDmEyZQRjfM/wBY+UL0F9NZNTzzzzzzzzzzzhePb0FjzYZpmfysJEoR9dbzzzzzzzzzzzy3XhfPrmIkRiTMIKW+0Nnzzzzzzzzzzzzz19m/Wn55JExGXhQPwqPWbzzzzzzzzzzzzzzwHQkUK8iuV05hlpmJjzzzzzzzzzzzzzzLn2XV3xWxTxYzx37G87zzzzzzzzzzzzzyvb711zz7Tzzzzz4z577zzzzzzzzzzzy3rzzzzzzzzzzzzS47zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz/xAArEQADAAICAgIABAYDAAAAAAAAAQIDERIhBBAwMSAyQEETIiMzYXFRYHD/2gAIAQIBAT8A/wCpKRwjiP8AWzO/dIpdfiUPRxf6HRo0cGycSRONaGtCXY5TLnoaHLS2SuzihTI2If2/l16TQhIUkykaNIcrTF9mji2PGjizixsT9L5tijYsaJhChCTO/SZxbHiWxQcBQjSGujJjr7RxpGz9n80LbEhe160cRIc+tHYpfrRePo+mcvjUtig4mNdDfFCqqfRyqWuXraX7mhI0J9nQ0aH0mys909SP+NPbJfKUzXRlnVv5I+hM1sU6M7/Y8fSReraSGnOM5U7RMrijiaOJo0NHkvWM8Xjz7MtLjpdtmOHM9jPI+9/JH16lv1mMKTemQpX0jN1jZj/Ov9k/SNGjQ5OI4PJjeNmJTzWxRE9pFUVRk05fyT9ep9WtyS2qRDTSZn/tMwreRCSSXvbHliVumY8k39DfReqlotcbf+GYsvPGXQ6Gx/HP16QhraLnVHjXtaPIf9MxPjSaM1ZZSrZ4ufn0zyPJqHpHi3WXG2zyLdZKT/ZngPqtlWOjyJSrZhtrobHTGzfxy2hUiR3xRG/3My09mGmrPI/IeMk8iPJyJzpIwulf8pl3z7Z4tccLZl7tv/lniVpUZMvf+hXVd/sZe0J6HRyGxfLj5Ma/qI0Zp3Bj/PJ5P5DDtNmZJYUeLG7bM8avZGZfwlKMvVIxW5T0X0hPpFPoY6GzYn38uEydUmQ+Rl/IzBHK0zJiVyRhmEXgq9J10Slj+i9Uu0JxD6ktumYy3tHLodDeh1tn16lfIjF9DSaFNz9MeO7fbMcKTZtHIpmR6QktbZX2J6Q6ORySKvYn2JCfZL+XG1xExe9lUcx0W/ob9OhsdDY2R2ytpE/ZK0vli9CoVoT9PQ/VMbNjY2OjfuH/ADIrJ3oxNN/PtiZFM5DsbHQ2OhsbY0xy/TY2YpL0jCtfoUbZsbGzs0ORSJIa2ZJ0x7Il0xTpDn/BC0hfMpbODEbG/wAa9VKZWIxY1JS2JaF88XpDo3+F/Al61+sT9L/xD//EACwRAAMAAgEEAQMDAwUAAAAAAAABAgMREgQhMDEQEyJRMkBBBSBhIzNgYnD/2gAIAQMBAT8A/wCJTI4Q/wB8lsTNld/7+SNr9ipNaNHBsnHo0kP4bN/LZyY2zR6F68i0fabk5SLWvhI9DodDZsbNnI5DtC+aF6804k0LHIpSNIbNjY2cjkOh2O2OmciMs+mcpfoZrbF5NELuevhsbHRyGxsbRzHRyGzkbFRGRJoXdHHv45lsWNjlohDekc6fo5MbGzkOh0U+w33ORyF3aROGJW6F9C+yLTitHIwZNwhePGuxsff4yNsn0Nmz+CqHbHZzGymcjpVyynV74djDNc1T7JGfIryPQjpH/Hkl/aM2NlPZvsUyfY/THZVDodHM+ofWWzpsussmfl9Omi82S+zZKZKZg2rF68c+jY2N/DKejG92ZHqGNjZsYsd29SjPjyY9JiWzG3NJmN8sSf5R1OJxlf4ZCJSJRjbfj2bGx0chGZGH9ZaTlmFYrbnR1WD6b5I6bpptbZ1kzhyqZ/B0sJYpa9tH9UX3SRGhL2dFTeNI6vEqnZMkoRjXlZopoxvZkW5MP6zqK1jZ00Pmm2Z+PB8jDx4LSOuXPqUkYO0JfhH9RndSYcP+m/8AsZMeKJS9s6V8a0Uty0cdNoUiRHlpm/tfxjr79GT/AG2zp/1GfupMDbzM621ONo6XIrxoyYWs7yP0jp9uNnUY1Vy36MTVU/8ACLW6ZifGkJ7GlzYtCQl38tsh7lovsYduzqK4w0Y8zitmTqatr/Bj6iY767su3ke2Q6jvLOOXIt0zFKmEkdU26SMD41r8mXHxpkT3QmlKNbYloXmyexPQ7h+0LJEekZbdsfxolGKOVL8IyU32XohamTK90xT3TFSpapEKJ9Ib2KRJGvNk9jGP44ik4ikxLsyYbofaUNbbYpFIkKTQvPcjkuGv4GnsfYTNiYmY9p7JmFWy636FIkJCkSNCQ/PxQ0zJjRx3/AsZwFApFJo0JGhISNDEP9jSHr8Gkz6YoNCjsKTRr4QhmxMfnrIkLJLN7HIpF4Ux0Ib/AGF4+ROLRxNGv3iT/wDH/wD/xAA6EAABAwIDBQYEBQMEAwAAAAABAAIDBBEFEBIgITFBURMwMkBhcSMzUIEiJDRCUhVichSAgpFgocH/2gAIAQEAAT8C/wBkhWpawg6+RQ+vtd9dJ2bq/wBMG1dX2ibIm+yDkU3uy5XV1q+hHZui6y7VPk3Jr9g8ECg7IcdpxV1qWpE3ysrZDh566Jyurq6uroyWC1Eq6JQTTvyujw2Qci5NVwj9Burq6ur5lyujldXRfndXyug/IoZjLVu70cPN2VsrItyuVfIu2wueR2wtQWoIOB+i629UZGrtgjMu0KMo5Z2CsFYLSrKyshkHhXCKtluVwta1k7AN/och35X27q+3qzurnasrIIGyD1qV7+fO4d1bb4q2Q2bdxdNO/O3mb5yu5eUHfXQ3jzpNhsTVkUZ6lHE38mpmJH9zFFNHKPwnvghtPkawXcVJiYB/A1DFZP4hQYlE/c7cVfYZw8xqKL3LtCtaunW0nOuqyz8DDv5reSocOGm8ifh0RH4dxTXSU83sU11wDlcBGeK9tYV9oZ22pJBG0uPJVFQ+Z9zw6KlpnTu9EMNp7c1V0JhGpu9qwycvaWHlw2GHf5d/hORzJV8nmzSU9xe4uPNUbQ6oZnXm9QbKEWiYPRTS9nGXKSolkO92UZ+Gz2Cv32JyeFn3yw9oFM31yrXAU0l+iwpp7Zzug2G8fLy8s7KyuE4ocFU/Ik9sqNwbUMRkYP3BT1zBuZvKpqVzndpJlXH4B982+FvttjIK2ziXz/tlQPb/AKZu9SVMLOLwpZZax4awfhVNA2CPSPvst4eWl45Wzc0LSgLKYXjcPTNuHOIBMm5RUcUfK5zxD5P3yaLuA9e6BG1ijfiMPplTwOmJAdayjwxn733TI2MFmi2YzYd3lpPEr7dlOzRM9vrlQSa4Lc27srZYl4Ge+UHzo/8AId7dA5Ym28TXdDlSS9nO09xHuPln+LZOQVlikemYO/kMqCbs5wOTt2xiX7MqX9RH77dlbuKhnaQvb6Z0k3aQt6jce4a6x8q/jthXWJx66e/8c6aXtYGuzxLxMyoh+Yb9+5KkrYo/UqPEA94bp47VVH2c7xlh8uibTydmNocPKP47Vs3gOaW9QpG6Hub0OWGS2e6M888S+Yz2yoPnE/2lSVrjcRt+6FdNdU9W2XdwOV7KTEImndvUFayV2ngcq+ocD2YPvlF8xvvmM8Tj8Mn2yBIIIULxJG13UdwOHlHjusSi0zB38so3lj2u6FNOpoPXLEfnD2yi1l2lv7tyhgZEzSB7qqj0TvCBLTcKnk7WIOWIyaYw0c8qUXqI/fKtN6h2Ufjb7oZBwJIvwzqY+0he30zwuXc6P7jzparbMkjY23cdy/qkWu2k2yxOPVBq/ic8Nk109v47lZYl+pPsMsMjBc9/TdliPz/tlS1QhY4Hf0VRO+Z13DLD23nv0GU51SvPrlH42++XBUB1yzydSp62KI24lU1U2cGwtbKqj7OoePXKik0VLD1Nv++4HDyxajsVcz6ifQ3hewUGHMYAX73ZSRh8b29Qjuywp9pHt6jLEf1TvbLDPlP/AMlU1el2iMXcqgS6/icbZYdGx8jtQvYKt/UP9MsLG+U+ylOmNzvRBvwHv/uyh+az3yr5uzhsOLlq/wBJRj+blS0jqg6ncFDDHCLMGWKss9j+ucLtcTHdRs2yHDzBaiLKrfop5HeiwqPVI555bFazRUye98qA2qmZV/6l+VPJ2NA9/PVuVFT6Wdo7xO3rEvn/APHLC2/MKrm2qX+uWFj8EnusRk0xaR+5Tx9nQxj1yp/nx/5J72saXOKha6rqO0d4GrEX6qjT0ChjEcbGjpniLNVOT0354cb0rNtvmCibrFD+V/5BYT4JPfYxVvxGO6jKi/VR++Vd+pkylbbDofdRG8bLdAsRN6k+2VHD2UAHNYlTlwEg5ccqKqbBqDuBTNVZU6j4QsU+XGPXKB4ZKxx5FHtq5/SNRxtjaGtU5/Ou/wA87qX8Ubx1GeGn8q37q6B2W+YfwyxBmqld6b1hclpS3rsYsPhxn+7LDW3qL9BlW0s3bPeG3BTKWZ7raCjTNNP2X9qjqJaT4cjdw4J7nSyOdzJVFQm4fJ9grKymw2N5u3cm4Vv3vUULIm2asTkY7Q0HhlRRiSoY08EGhu4DKubpqn/9qCQSQsd6bEotI8f3HKkZop4x6bbfMORT2hzSDzCe19PP6gqCZs8YcEQgsVlu9jOnHLD6fs4tRG92y5jX+IXTYIW8GDZmnjhbdxT6qpqnaYxYKppzAWgm5IywsfmCegyKxKG7RIOXFYdU6T2bjx4ZyvEcbnHkibklUkBmmA5c8hsgeZdnV0Ynbu8QTH1FHJ/8UeJwO8W4qbE4wPh7yiXPcSd5Ko8PNw+Uew7uonbDGXFRxzVspJO5RwshbZgWJOvUn0GWEM+Y77ZWRYCLFVVC+I6mb2qnxEsGmTf6r+oU1vEqusM+4bmqGnkmdZo+6pqdsDLDjzOQysrebdsSRRyCzmgp2GU54XCGFQeqipYI/Cwd5iEhlqRGOW77qCFsMTWDKtdepl98sMbpp79TsyUMEnFq/pUPUpmHU7eV01oaLAZjILn5t/k6Ua8R3/yJRRNgSnm73H1QFyAoWaImN6DuwgigPNu722zZQ/CxIg/yP/tWVa7s6d59MsPh7Sa/JveNyPnHDurq+d1fYxOEtkbO37qnrY5IwS6x5rEKoSkMb4QmML3ANG9UtOIIgOfPvBsDzZGdlbvnMa5pBG5SYTv/AAPQwiTm8Kno44OHHrlbuwEfP2VsyNiyttW8ly+ikZWVvIWKsrbQ2B9DsM7dxZWVsrLSrZWVtofSLq+VlpWhWystOVlZW2jsj6OdoeQIysrfQybK5QcVqQP11wRy0rSUArK2VvKm/wBE0hW/8+t5sf74f//EACwQAQACAgEDBAIBBAIDAAAAAAEAERAhMSBBUUBhcYGRoVAwscHw0eFgcID/2gAIAQEAAT8h/wDU97r/AMBph/Nqo05xDFzh/Jl6qysbYYs0zmD0r/AcTn0Pe8rqdnOocwpORkd8fwddL1FxB0MPEIROgk2GOcXnrvPadsghla5nxh69lxS8Wy/eEALYq9EuNQHmCOXge9L3gMjhOJaDlvEWKyb9dXKYbY4AxOBSW2sJBMeJlWCFwlsvi6lkWme9HbkjzDLDj064Xl8bS5cAm0UuMXjHEVeWXLYDCjctaqd5xwMOWeY8UDBrFZrfQs4vTpKmoktPfKIy0Wp7E3ilcwe2LwRMbQ0Icw6hi5cGEVRN5zgQJXT3hx6dehQ5xhHM9thJohZviUqG5cdkOiIYnWOtYrbg3DhasD3Rl7SOAMNMIQMJ0HPp76NS+g6i1HobGDLxrLJeBw6YRdupxLz3JauGBcqoQ4GWp5yV8dMc+mTNxY7GXHebxUrDFSsjhCPnDUVwJUAlEYNZYXgUhYyKjAb9Oxi5c21+5cuMeg/pLLjgy+q5vBg0znHsww9MsXNgxVVwR8X7BGumWu17S0/V0Ji+kNRJWChDJG9UlEs92BdyRP8AFQGSPM9ItDFG7lLmEC0JS2SiKQDmDafIWVSN+JuNh4k7CAZwl4oWoTuwwuX0KMrAgy8pfoREnshUGjyzUNmXL2fiLPb+roXTy5D0jqBgqQeIEdIwPFlzvmIBvm/xhYHtgRGOxgN9o64PBLl1n+xCLxeBnMDBgl4cDedsIh3K48mqHzEdlT+ehUHAelehhm0qRKKxWJz/AH4Y11shVv5IK7/vPe/YPfH4tk0XgZuEI3NZc26Bjj+OKanSwe/iG42Wj/twBsXa9+nYOL9ItcHlOJVxWyPvxvd5x1qELBYvU2/yHKoHnH3iB1mLMS4wgYq83PVgG0+Mq7GL6Dawlek5JWCMslke+diO12eKeEkcFowNn/tf9IhjSLLn+sV4ujh0/cOgxVzZviFel5pWOZWDNsP9zKxYDkMXH5wb6RWCGKgYthAqDPdCHTWLt/0EGEJUCBjQdvUdRjzHc4QhaJtXgU2Qe4VT8keMfouLvbP7Ok6Bq49V/FEtUVXgJUrHiC7PvG8+H7xWB08XqFiDEwoJYRHcIRVOUMdgG58kSNR6PfithoGi10EB2R9ps/8AywIgWtEoBZ0RZxLh2kVh+jwQZ1l8sOxsbIb/ACfeTpND0my+isMXPi0fswLfJKD4Fxj1eMR3XACDjbzCJ4uz7hlKSecuH5ipue/jH5w/EufiZj9NBg6i+R4xU1pvh8xN4ud26SpU7kOPSJcr4wqVhiUgJwG5zDYM0LmzNEnaik0xSh7KfeDp7nBqNmxANCjRi48llTw/fH6aBGgsTtemfjTJcouRKniPY+8eCrEFdNwPTncIGJhJvGihPPHexCMzukCkezWNg9z8S4r+Bg7oXdv9QIXvbFKuwRFRxQx9UEFrspYruTAsPbi0btnxLj934uJWS+3zHFC8UocKfrAolT2SWHONyn1QQYPaPH09PuD2d194rFT7NH3j5heP7LHkAvtxCEL504/hhr+EjfGONz7ZXttfqWebbuDY+yVsAIjPZx/iMB7R9sKjiK3jzszL4HZCGQxx9QgLl6Ur3gyv29FfnJ+OilfzYb7V/cJ/B/tSk+BAVolxctsAnf6sMEX+4Q0b/jO019wxwPCyl1Uw+qCbp7H9M7fUslYDzqZo+T+6E2equGcsbjVfCDf7dfUrDA+YP1hfFuwhgi9Q4Q92eB9PuCLXkyoHKlY6wG9jFD38T2XK3Ud2OFra8BDfd9QKsB4wzfKD7gA75VqAN2/uYvHnZ+8Fwb6Br0rhnbNpwvIMofFo+I9fyeHAIRLxv5OE8qvrPEuHUPyjtkfiEM/U8eZYZ7E3V0cX+Qypyj811+EBtT9kqVHC4REOVlQ9d/GBQBBbKmxhi30jisM7M3ahxM4CnlcME5yflv1kv4VH0QjoNSuoz9DZ5ZqbOXweCGavl7songxu+OGpVeYwoR5j0tl65JVGn5TkfhHqqe3n5l0NfhOWX5EqHeC0pAIPqe3ooaIrf5ELyubGx5jK6KgdO7PiPdO2By+Wanwan4w+l3sVKlXGlpfJNs9s/cymMPbohBFIGHrFTSdNSpXW8M2X/TYewBHY7pjEd2F4h66wmehLuQ9R2wqVK6KzUqVhRElSox78F/hG02ttofeHFne6KjisGCDVznAwHqdEqVEiYcWy8KwSWSkpLJZLns629zvAxDwY7Pu+WWRE1O+FtQ66xUCM4nEW5UHq6MViqOHJ1kuTI2QltR4Yx4EHsX5pT1gxUqM70WT1lWVlRJowysCKlSsVhWCaxWazXUZG3+AqOa0azUolEqVAZU3KlVipUqBLu0aw6g3OMMEP4ComCsPjKrAPW2lQcDKHbDYmsTpFZr+DYkFCNTaBjFzFmEVKSkpK6jKyeipWK/glYDA11V03CIwyVhS4FfwcfNhWlhHNYOmodVQ6UwGa/gLN4Fwcoid8GKhAdV/1h2MOipXrle0Acf1g/jmX628H8C+rPWP/ALb/AP/EACwQAQEBAAICAQQCAgIBBQEAAAEAESExEEFRQGFxgSCRUKEwsfBgcIDB0fH/2gAIAQEAAT8Q/wDaff2s/wDQHElnPIstD/OMVyviGSyIDkf4Up/zAIP8RLt53VYaLa2FHTuVSIMGAT+IiHt/wC/CE/5CCin8Uz4ImISsSI8Adw6uIk6TpniEQfCcf7f8W/UOdQB4/i8FLaq/xxuT14G223K4OrcstyxZZcGloF62xmfr0/lkeW54TvtbtYnT8JCCfXqzFliIDpnmxMlygTi8Rbw8w+cWEEtJbmSnCyAkNjXbqu3h6gevGrHAWDwsHs2G9LinghPi1A3D6hvjP4MPd6CfmkzlgZ3A9WLrLOtwvuca7ByQljZ8vqXCIUlu8vS0JHFkJB7gNPqTYdRBL7h3CGqQ7BDjwDfONyPDPp82c+r4iPil/Ev7lJ3HiXufBw7sR5lfcTi5k90bQ9x8kNsGQzY/AMdIum7N28FzrZPE0TvYWKcwIEQMfG2BnhmXLX09vY9tkVeJs9lBeonq7Vn6ZfkUntE2jIwj1uVVnEsW4L1EFznwx3Uy8im8XuWwyWQ2/nqzna5umcwchxclj4gPCc+MyjB9OHnYXVhJRc8vFZl9jdLELkp5q9shCAdT8cvJOmYilq3a8YBxbkQsrxHI3xp5Ri0MB+i13WFDmaKRDGBbiLNnyDOx6+lXJT/DZj8RBNRC20llg6cwiQR8TDe4Hu0tJeJ8bB7nOQw3BGfM9l4UiwiNu2YeLWG2kjPhoBhYzNzEfTCJ4RIwrehtqtxHhc8NsPdwiBe7GRW5gyXPd3xJNyZ6+W5y1+IX3ZnD4XEE+EIvuQGG4sPicOzx9MzL0ePK1XTNZHKxsJhtsyZ55I/gsjN44kmD/DYcCbk6i7LJ0IWGzPDlDk+l03uwJHmXXw3BcGyoeV2YeJPmGEsUD5MyVfn2IPHZ3cEAM+lhLDbCrbGXssfCllHkWI/HteSsg92fzHYiInFtrKFx8Nt7h9JsPgle1wwIfDDyWF7gDHTZQluITiHovlKvyrL16bn1MPhi2DdxPUk9WiH7t3qWBh7WIOw62w8ltLUL40gyYlytQRmhQ282FDazjAKbcBLRXF+QNtxeA/NxbkU9rjkuPBB6w9eGfpNd8mXALrLdROtO42AxLIZMjp/6TGaqxt6Dz+Gw+AZwo783b8BuTzPB8s0MLpsC1u67Ktau39LGN2yHptsIfSWR89eo8OH1vwnsa4t/qQuoA/K+cVflW8y2pa983f0zj81/68DS36bPcLgN1LBzg8ASA7I9RBhKL9yzFn4TM9QHRZoQ+UK3jjqwD58Jfblf0Qls8JWpg4ghbj4nLozhC7xDLDJ6fx4sZ6RFn6CezTGXfr/lToavuYMFhepHywWk/R20L4IFhmA4kd7cTGRIgdYfiz/qClenLsY47N1CDpUZDObyh8EeMP7/ALhg4Cx85Gkm0jTkvSuXj3uSPiXD4Y/Z4KMxqK8jEvtjhHvt6d/nwYlvj3JXwi5r9JYCvxkAYl7aQj5LOYZmdQnCX/5WR5nuN95NfjstDifuCE+e3x/585Drxlng/gVfFfAp6iOJ93w2dz/ri2G5gjkWxx3N0cRJGj9I3+gSW4LNTiTuDbI8IU5pxyfnw4pj19n0yaKT0+H++eMb8b/oW3wHgmcdXNzJvXikqSjDdm6TZD7JE/JBRHIowo6W4uj+ycrKz5InPuA6ZNmwRNn6Jg6fGEQaTxLPFxEjKNh/19+EDsHRtl8T/XMIhl1fHtPlf7QWWER2QjSBYBcDO2aHJ6ikyOSw8BDEm7ZuYv1/DYfgx9j1B8ROLZWOCHiHfD38f0i5D9rCyMlzCckmEB1zeoP2Zdu6fvjeoWXBYGRgPwvACaSFm4dvFvhPkWRjj16/DwNjByrKWh7Oo4n1j7t+m2zG0S66u3y//wCkGbDwJxcFv63w5JBJ9xukY0fHRIOIIN6ICyOWYD8fSNitsmeCsJvLAmeOsryUHmYQ/mLrxa/FfDTfMeexdkk3sHKgYzj/ALcpxy9GH24x+yylr/o8MQ9f6G+K/Yn9B4WJ/wCWwMBNqMZPOvHygzik/isEJyOeNr8sP7PcEFkEQhx+a5B+kMIml2lxKnjImV2T0W0DKBXmdJpEYcL9Xh8pr6IuRAHrxdyhfZageoBvCezGG6im+0+OOtP7xCSSn7rwHfBewYAav2ObkNmIm5h36/yzIxGklEl+bfwcvCbWfofCCDIDYObCUICeAoJ6+kydkXZYyXGrdTDP2/MQjwY9kAAiX0/dJCciiPhOM8avxM/maN5vxDw5/L/6F6ZMpzNuRvwHwlYnpYOxAP143+DBpM3DKQ5D/wC3x9wpyLgyyO9dsAxmv3KfnVkuCqOz7YYcc3/P4ICxHR+5Zq8f25agKEmLZgRPQ/T9gEw5ZKmvc5DiL8nG5eEj8o9sc+5uGc/KDnN+kk9T37B4MZ0v5gDZOhpdg2Px+HivjJYX4vgPuR/ovSZE+yTBDfmfH3+stm87L5OAvt1Ef0JIxaBftuE9WeGjPOnXn/SYiwk5nri0kSbo+ocJmTXj1IA9S+YNPBLxfFar+fgr9lf9N834GTwgBx/usSI0j8QgPVjQKrhZHCfReGA9zmEWImQXWOOfHVHne/8AUeAhVyH2kBqoOY/7flherE/gCOqfCCeZl7nH9kSJo9+GKlCPUUWO4Msuz9Kub3K5fJZd2EtVDf4H+0cF+47kxXZ/Y8BuOYrbGk8w9AvIYEUeZBfs926/peLUYPvcco5eN9QgQiYjPxfsdT45teiCnDlO37swtXnxrzlR9hGekwMvfPdnDhn8gnr69/Jw2MTpH2upw5+vBRGY/k5QSHJZoDiy0nG/P0vbwpcHxFFxl9kyZctN+ZzyMD3QhI9w1nWk16uLTFD2et0ZZtgOCJlDfA2+4DPIyQ+LHE+HtTF1cz/7sBr8Du+PfmuQc3dDlofu2FJ9b0eQHgFZudWr93m0dVG+BF0AMCwC6ZlmvOJ7kcyLkgAw+j5xs+HS718GcE35/szgc78Tj+PeHkidQYKZHIlt41VsMTynbBg4AYTpsksyBZ4jclt3bHHznqTttvroLZiBfTBPG7/RS6LLCGBINA+5h/CdpMNDqM+X+nMFcjfkvmCvlCMBD8159y8MvDRGuQuoED6dLG46sJA9S6zH7tE+D7Zwm9+2rcW3zcsH1PysCJG3ISLBlrZa+BHzpLHrvuXtsUSjnXxMlheBrJ2X8WwiQhX74WeQCSYl0OE/QyxIFYjst3KXU+Bcj9QpLT97/ACCzPA3qdHmy68hBLPwWs+5/vUu5G48Iv4CV7Vx/LCRyAfu+NI/mcoNsWAhywlth1YItkXfqEWFUt25RdXDIWLHITJjiGkfKPg8IvAEb0Cfoywu0OPPyN8dnfLgiBYULIw2XBnmBGaFyuIJaWDWAPqdNZzN1J4QSB34cM8T7b5J3TJe4+e1t4+SzFE9gvXVCwZjs5LcsisW+BALsj+ZMCCCDLebILUBs+kJMY4SMZEA+qQRk6deHU8YnqDlkMJkSA93B1PfgIM8CBtlJbhuuI6cpcc1p6jFl14DWILDLOwPDJLo+Nfm6n1aTIJmJ8RK4sI71Ly18yzwufiFiIeRBLrYJyxXi2dngIoeDufB4SCyFiDgLYV+sTbRF7uHSx6tJObGpb3FOerrGbUE/OxEY5dWJvPJO0i5JLA8hZaksBM3rzsIPrkMHU6Nw6s05J+4rsPjvPgOPIsnUgw+gndt7cdceC5p0xg2zmIbHfCTbJEMf4B0PHuYFwwqYX1IHDPrQJ6jpEQawbbxhdQD15HwYazMvdwWTc22M3f17bjJE9TcfGGHdh5IbafEmkZtY862WnmEvaSVsb34hieCVWPJ9W2bDuB7QPe2/V2ncNPGQIOI6+W5bpDyfwjP48/EjfNFk/wB9Y+B68CngZgcyrhg9pNh1DkiP4HHgPjLP+LJScFsAX+Go+tZ9ruIfgj+Z/Bnf8ePiFCv1mp3bt/gRpEDPqdba9/xb7/81n/yh//Z';

  downloadPDF(): void {
    const doc = new jsPDF();
    
    // Get document width
    const pageWidth = doc.internal.pageSize.getWidth();
    
    // Image dimensions and position
    const imgWidth = 30; // Set the width of the image
    const imgHeight = 30; // Set the height of the image
    const imgXPosition = pageWidth - imgWidth - 10; // Position 10 units from the right
    const imgYPosition = 5; // Top of the document

    // Add the image at the calculated position
    doc.addImage(this.base64Image, 'JPEG', imgXPosition, imgYPosition, imgWidth, imgHeight);

    // Adjust text position to avoid overlapping the image
    const textYPosition = imgYPosition + imgHeight + 10; // Place text below the image
    
    // Add the report title and generation date below the image
    doc.text('Employee Report', 10, textYPosition);
    doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 10, textYPosition + 10);

    // Add the table with employee data
    doc.autoTable({
        head: [['First Name', 'Last Name', 'Email', 'Phone']],
        body: this.filteredEmployees.map(e => [
            e.empFirstName, e.empLastName, e.empEmail, e.empPhone
        ]),
        startY: textYPosition + 20, // Start the table below the text
    });

    // Save the PDF
    doc.save('Employee_Report.pdf');
}

    exportExcel(): void {
        const ws: XLSX.WorkSheet = XLSX.utils.json_to_sheet(this.filteredEmployees);
        const wb: XLSX.WorkBook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'Employee Report');
        XLSX.writeFile(wb, 'Employee_Report.xlsx');
    }
}
